
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../funnelcake/">
      
      
        <link rel="next" href="../vpn-subscriptions/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.19">
    
    
      
        <title>A/B Testing - Bedrock Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#convert-experiments" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Bedrock Documentation" class="md-header__button md-logo" aria-label="Bedrock Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bedrock Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A/B Testing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mozilla/bedrock" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bedrock
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Bedrock Documentation" class="md-nav__button md-logo" aria-label="Bedrock Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Bedrock Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mozilla/bedrock" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bedrock
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Install
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../l10n/" class="md-nav__link">
        Localization
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../coding/" class="md-nav__link">
        Developing on Bedrock
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        How to Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pipeline/" class="md-nav__link">
        Continuous Integration & Deployment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        Front-end testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../redirects/" class="md-nav__link">
        Managing redirects
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../newsletters/" class="md-nav__link">
        Newsletters
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contentful/" class="md-nav__link">
        Contentful CMS Integration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sitemap/" class="md-nav__link">
        Sitemaps
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../content-cards/" class="md-nav__link">
        Using External Content Card Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../banners/" class="md-nav__link">
        Banners
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../uitour/" class="md-nav__link">
        Mozilla.UITour
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../send-to-device/" class="md-nav__link">
        Send to Device widget
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../download-buttons/" class="md-nav__link">
        Firefox Download Buttons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../mozilla-accounts/" class="md-nav__link">
        Mozilla account helpers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../funnelcake/" class="md-nav__link">
        Funnel cakes and Partner Builds
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          A/B Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        A/B Testing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#convert-experiments" class="md-nav__link">
    Convert experiments
  </a>
  
    <nav class="md-nav" aria-label="Convert experiments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qa-for-convert-experiments" class="md-nav__link">
    QA for Convert experiments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-cop-experiments" class="md-nav__link">
    Traffic Cop experiments
  </a>
  
    <nav class="md-nav" aria-label="Traffic Cop experiments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coding-the-variants" class="md-nav__link">
    Coding the variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-variation" class="md-nav__link">
    Content variation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-page" class="md-nav__link">
    New page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-cop" class="md-nav__link">
    Traffic Cop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switches" class="md-nav__link">
    Switches
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recording-the-data" class="md-nav__link">
    Recording the data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-the-data" class="md-nav__link">
    Viewing the data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    Tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ab-test-prs-that-might-have-useful-code-to-reuse" class="md-nav__link">
    A/B Test PRs that might have useful code to reuse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avoiding-experiment-collisions" class="md-nav__link">
    Avoiding experiment collisions
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vpn-subscriptions/" class="md-nav__link">
        Mozilla VPN Subscriptions
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_21" >
      
      
      
        <label class="md-nav__link" for="__nav_21" id="__nav_21_label" tabindex="0">
          Attribution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_21_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_21">
          <span class="md-nav__icon md-icon"></span>
          Attribution
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/" class="md-nav__link">
        Attribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0001-analytics/" class="md-nav__link">
        Mozorg Analytics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0002-firefox-desktop/" class="md-nav__link">
        Firefox Desktop attribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0003-firefox-mobile/" class="md-nav__link">
        Firefox Mobile attribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0004-mozilla-accounts/" class="md-nav__link">
        Mozilla accounts attribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0005-affiliate-marketing/" class="md-nav__link">
        Mozilla CJMS Affiliate attribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0006-pocket-analytics/" class="md-nav__link">
        Pocket mode attribution
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_22" >
      
      
      
        <label class="md-nav__link" for="__nav_22" id="__nav_22_label" tabindex="0">
          Architectural Decision Records
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_22_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_22">
          <span class="md-nav__icon md-icon"></span>
          Architectural Decision Records
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architectural-decisions/" class="md-nav__link">
        Architectural Decision Records
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0001-record-architecture-decisions/" class="md-nav__link">
        1. Record architecture decisions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0002-move-ci-cd-pipelines-to-gitlab/" class="md-nav__link">
        2. Move CI/CD Pipelines to Gitlab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0003-use-cloudflare-workers-and-convert-for-multi-variant-testing/" class="md-nav__link">
        3. Use Cloudflare Workers and Convert for multi-variant testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0004-use-fluent-for-localization/" class="md-nav__link">
        4. Use Fluent For Localization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0005-use-a-single-docker-image-for-all-deployments/" class="md-nav__link">
        5. Use a Single Docker Image For All Deployments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0006-revise-tooling-for-python-dependency-management/" class="md-nav__link">
        6. Revise tooling for Python dependency management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0007-further-revise-tooling-for-python-dependency-management/" class="md-nav__link">
        7. Further revise tooling for Python dependency management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0008-move-demos-to-gcp/" class="md-nav__link">
        8. Move Demos To GCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0009-use-manage-contentful-migrations/" class="md-nav__link">
        9. Manage Contentful schema state via migrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0010-move-ci-cd-to-github-actions/" class="md-nav__link">
        10. Move CI to Github Actions for Unit and Integration tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0011-use-statsd-for-metrics-collection/" class="md-nav__link">
        11. Use StatsD for metrics collection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../browser-support/" class="md-nav__link">
        Browser Support
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#convert-experiments" class="md-nav__link">
    Convert experiments
  </a>
  
    <nav class="md-nav" aria-label="Convert experiments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qa-for-convert-experiments" class="md-nav__link">
    QA for Convert experiments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-cop-experiments" class="md-nav__link">
    Traffic Cop experiments
  </a>
  
    <nav class="md-nav" aria-label="Traffic Cop experiments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coding-the-variants" class="md-nav__link">
    Coding the variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-variation" class="md-nav__link">
    Content variation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-page" class="md-nav__link">
    New page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-cop" class="md-nav__link">
    Traffic Cop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switches" class="md-nav__link">
    Switches
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recording-the-data" class="md-nav__link">
    Recording the data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-the-data" class="md-nav__link">
    Viewing the data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    Tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ab-test-prs-that-might-have-useful-code-to-reuse" class="md-nav__link">
    A/B Test PRs that might have useful code to reuse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avoiding-experiment-collisions" class="md-nav__link">
    Avoiding experiment collisions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>A/B Testing</h1>

<h2 id="convert-experiments">Convert experiments<a class="headerlink" href="#convert-experiments" title="Permanent link">&para;</a></h2>
<p>Conversion rate optimization (CRO) experiments on bedrock can be run
using a third-party tool called <a href="https://convert.com">Convert</a>. Convert
experiments are for relatively simple multivariate experiments, such as
testing changes to headlines, images, or button copy.</p>
<p>The Convert script is not included in part of bedrock's base bundle for
performance reasons. To use Convert on a page, you can load the script
behind a feature flag, which can be turned on / off for only the
duration of an experiment. The script should be loaded inside the
<code>experiments</code> block in your template:</p>
<div class="highlight"><pre><span></span><code><span class="cp">{%</span> <span class="k">block</span> <span class="nv">experiments</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">switch</span><span class="o">(</span><span class="s1">&#39;experiment-convert-page-name&#39;</span><span class="o">,</span> <span class="o">[</span><span class="s1">&#39;en-US&#39;</span><span class="o">])</span> <span class="cp">%}</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">js_bundle</span><span class="o">(</span><span class="s1">&#39;convert&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</code></pre></div>
<p>Convert A/B tests can be implemented using the <a href="https://convert.com">Convert
dashboard</a> and editor. Convert experiments should
be coded and tested against staging, before being reviewed and scheduled
to run in production.</p>
<h3 id="qa-for-convert-experiments">QA for Convert experiments<a class="headerlink" href="#qa-for-convert-experiments" title="Permanent link">&para;</a></h3>
<p>The process for QA'ing Convert experiments is as follows:</p>
<ol>
<li>Bedrock feature switch should be activated on staging.</li>
<li>Experiment is built and configured to run on
    <code>https://www.allizom.org/*</code></li>
<li>In the Github issue for an experiment, someone will request review
    by an engineer.</li>
</ol>
<p>An engineer reviewing the experiment will:</p>
<ol>
<li>Verify that the experiment is not configured to run on
    <a href="https://www.mozilla.org/">https://www.mozilla.org/</a> (production) yet.</li>
<li>Activate the experiment to run on stage.</li>
</ol>
<p>During review, the engineer will compare the following to the experiment
plan:</p>
<ol>
<li>The experiment's logic.</li>
<li>Any JS included (in Convert editor's JS field).</li>
<li>Any CSS included (in Convert editor's CSS field).</li>
<li>The target audience is configured.</li>
<li>The goals are configured.</li>
<li>The distribution percentages are configured.</li>
<li>The target URLs are configured.</li>
</ol>
<p>Once the engineer is satisfied, the engineer (or someone else with write
privileges) will:</p>
<ol>
<li>Add <code>https://www.mozilla.org/*</code> to the list of URLs the experiment
    can run on.</li>
<li>Reset the experiment (eliminating any data gathered during QA).</li>
<li>Enable the bedrock feature switch in production.</li>
<li>Activate (or schedule) the experiment.</li>
</ol>
<p>After an experiment is finished, the feature switch should be
deactivated in production.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>*</code> should be replaced by the exact URL pathname for the experiment page.</p>
</div>
<h2 id="traffic-cop-experiments">Traffic Cop experiments<a class="headerlink" href="#traffic-cop-experiments" title="Permanent link">&para;</a></h2>
<p>More complex experiments, such as those that feature full page
redesigns, or multi-page user flows, should be implemented using
<a href="https://github.com/mozmeao/trafficcop/">Traffic Cop</a>. Traffic Cop small
javascript library which will direct site traffic to different variants
in a/b experiments and make sure a visitor always sees the same
variation.</p>
<p>It's possible to test more than 2 variants.</p>
<p>Traffic Cop sends users to experiments and then we use Google Analytics
(<abbr title="Google Analytics">GA</abbr>) to analyze which variation is more successful. (If the user has
<abbr title="Do Not Track">DNT</abbr> enabled they do not
participate in experiments.)</p>
<p>All a/b tests should have a <a href="https://mana.mozilla.org/wiki/display/EN/Details+of+experiments+by+mozilla.org+team">mana
page</a>
detailing the experiment and recording the results.</p>
<h3 id="coding-the-variants">Coding the variants<a class="headerlink" href="#coding-the-variants" title="Permanent link">&para;</a></h3>
<p>Traffic cop supports two methods of a/b testing. Executing different on
page javascript or redirecting to the same URL with a query string
appended. We mostly use the redirect method in bedrock. This makes
testing easier.</p>
<p>Create a <a href="http://bedrock.readthedocs.io/en/latest/coding.html#variation-views">variation
view</a>
for the a/b test.</p>
<p>The view can handle the URL redirect in one of two ways:</p>
<ol>
<li>the same page, with some different content based on the
    [variation]{.title-ref} variable</li>
<li>a totally different page</li>
</ol>
<h3 id="content-variation">Content variation<a class="headerlink" href="#content-variation" title="Permanent link">&para;</a></h3>
<p>Useful for small focused tests.</p>
<p>This is explained on the <a href="http://bedrock.readthedocs.io/en/latest/coding.html#variation-views">variation
view</a>
page.</p>
<h3 id="new-page">New page<a class="headerlink" href="#new-page" title="Permanent link">&para;</a></h3>
<p>Useful for large page changes where content and assets are dramatically
different.</p>
<p>Create the variant page like you would a new page. Make sure it is
<code>noindex</code> and does not have a <code>canonical</code> URL.</p>
<div class="highlight"><pre><span></span><code><span class="cp">{%</span> <span class="k">block</span> <span class="nv">canonical_urls</span> <span class="cp">%}</span><span class="x">&lt;meta name=&quot;robots&quot; content=&quot;noindex,follow&quot;&gt;</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</code></pre></div>
<p>Configure as explained on the <a href="http://bedrock.readthedocs.io/en/latest/coding.html#variation-views">variation
view</a>
page.</p>
<h3 id="traffic-cop">Traffic Cop<a class="headerlink" href="#traffic-cop" title="Permanent link">&para;</a></h3>
<p>Create a .js file where you initialize Traffic Cop and include that in
the experiments block in the template that will be doing the
redirection. Wrap the extra js include in a
<a href="http://bedrock.readthedocs.io/en/latest/install.html#feature-flipping-aka-switches">switch</a>.</p>
<div class="highlight"><pre><span></span><code><span class="cp">{%</span> <span class="k">block</span> <span class="nv">experiments</span> <span class="cp">%}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">switch</span><span class="o">(</span><span class="s1">&#39;experiment-berlin-video&#39;</span><span class="o">,</span> <span class="o">[</span><span class="s1">&#39;de&#39;</span><span class="o">])</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">js_bundle</span><span class="o">(</span><span class="s1">&#39;firefox_new_berlin_experiment&#39;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</code></pre></div>
<h3 id="switches">Switches<a class="headerlink" href="#switches" title="Permanent link">&para;</a></h3>
<p>See the traffic cop section of the <a href="http://bedrock.readthedocs.io/en/latest/install.html#feature-flipping-aka-switches">switch
docs</a>
for instructions.</p>
<h3 id="recording-the-data">Recording the data<a class="headerlink" href="#recording-the-data" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are measuring installs as part of your experiment be sure to
configure <a href="https://bedrock.readthedocs.io/en/latest/firefox-stub-attribution.html#measuring-campaigns-and-experiments">custom stub
attribution</a>
as well.</p>
</div>
<p>Including the <code>data-ex-variant</code> and <code>data-ex-name</code> in the analytics
reporting will add the test to an auto generated report in
<abbr title="Google Analytics">GA</abbr>. The variable values may be provided by the analytics team.</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">href</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;v=a&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="s1">&#39;data-ex-variant&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;de-page&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;data-ex-name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Berlin-Campaign-Landing-Page&#39;</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">href</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;v=b&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<span class="w">        </span><span class="s1">&#39;data-ex-variant&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;campaign-page&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;data-ex-name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Berlin-Campaign-Landing-Page&#39;</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p>Make sure any buttons and interaction which are being compared as part
of the test and will report into <abbr title="Google Analytics">GA</abbr>.</p>
<h3 id="viewing-the-data">Viewing the data<a class="headerlink" href="#viewing-the-data" title="Permanent link">&para;</a></h3>
<p>The <code>data-ex-name</code> and <code>data-ex-variant</code> are encoded in Google Analytics
as custom dimensions 69 and 70.</p>
<p>Create a custom report.</p>
<p>Set the "Metrics Group" to include Sessions. Configure additional
metrics depending on what the experiment was measuring (downloads,
events, etc.)</p>
<p>Set the "Dimension Drilldowns to have cd69 in the top position and cd70
in the drilldown position.</p>
<p>View the custom report and drilldown into the experiment with the
matching name.</p>
<h3 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h3>
<p>Write some tests for your a/b test. This could be simple or complex
depending on the experiment.</p>
<p>Some things to consider checking:</p>
<ul>
<li>Requests for the default (non variant) page call the correct
    template.</li>
<li>Requests for a variant page call the correct template.</li>
<li>Locales excluded from the test call the correct (default) template.</li>
</ul>
<h3 id="ab-test-prs-that-might-have-useful-code-to-reuse">A/B Test PRs that might have useful code to reuse<a class="headerlink" href="#ab-test-prs-that-might-have-useful-code-to-reuse" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://github.com/mozilla/bedrock/pull/5736/files">https://github.com/mozilla/bedrock/pull/5736/files</a></li>
<li><a href="https://github.com/mozilla/bedrock/pull/4645/files">https://github.com/mozilla/bedrock/pull/4645/files</a></li>
<li><a href="https://github.com/mozilla/bedrock/pull/5925/files">https://github.com/mozilla/bedrock/pull/5925/files</a></li>
<li><a href="https://github.com/mozilla/bedrock/pull/5443/files">https://github.com/mozilla/bedrock/pull/5443/files</a></li>
<li><a href="https://github.com/mozilla/bedrock/pull/5492/files">https://github.com/mozilla/bedrock/pull/5492/files</a></li>
<li><a href="https://github.com/mozilla/bedrock/pull/5499/files">https://github.com/mozilla/bedrock/pull/5499/files</a></li>
</ul>
<h2 id="avoiding-experiment-collisions">Avoiding experiment collisions<a class="headerlink" href="#avoiding-experiment-collisions" title="Permanent link">&para;</a></h2>
<p>To ensure that Traffic Cop doesn't overwrite data from any other
externally controlled experiments (for example Ad campaign tests, or
in-product Firefox experiments), you can use the experiment-utils helper
to decide whether or not Traffic Cop should initiate.</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">TrafficCop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@mozmeao/trafficcop&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">isApprovedToRun</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../../base/experiment-utils.es6&#39;</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isApprovedToRun</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">TrafficCop</span><span class="p">({</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;experiment-name&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">variations</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="s1">&#39;entrypoint_experiment=experiment-name&amp;entrypoint_variation=a&#39;</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span>
<span class="w">            </span><span class="s1">&#39;entrypoint_experiment=experiment-name&amp;entrypoint_variation=b&#39;</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">cop</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>isApprovedToRun()</code> function will check the page URL's query
parameters against a list of well-known experimental params, and return
<code>false</code> if any of those params are found. It will also check for some
other cases where we do not want to run experiments, such as if the page
is being opened in an automated testing environment.</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.top", "toc.follow"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>